<form [formGroup]="caseForm" (ngSubmit)="formSubmit(caseForm)">

  <div class="container">
    <div class="row">
      <div class="col">

        <div>
          <label class="label ">
            <h5>{{taskName}} ({{caseId}}) (Status : {{requestStatus}})</h5>
          </label>
        </div>

        <label class="label required" for="input-email">Received From/Scheme Official </label>
        <nb-icon icon="question-mark-circle" nbTooltip="The person who made the request" nbTooltipStatus="primary"
          status="info"></nb-icon>
        <!--        <input nbInput fullWidth type="text" formControlName="receivedFrom" id="input-email">-->
        <nb-select placeholder="Scheme Official" fullWidth formControlName="receivedFrom" id="input-email">
          <nb-option [value]="officials.email" (selectionChange)="selectedSchemeOfficial(officials)"
            *ngFor="let officials of schemeOfficialsList">{{officials.email}}</nb-option>
        </nb-select>
        <div *ngIf="submitted && form.receivedFrom.errors" class="invalid-feedback">
          <div *ngIf="form.receivedFrom.errors.required">Received from is required</div>
        </div>
      </div>

      <label class="label required" for="input-subject">Subject </label>
      <nb-icon icon="question-mark-circle" nbTooltip="What is the request about" nbTooltipStatus="primary"
        status="info"></nb-icon>
      <input nbInput fullWidth type="text" formControlName="subject" id="input-subject">
      <div *ngIf="submitted && form.subject.errors" class="invalid-feedback">
        <div *ngIf="form.subject.errors.required">Subject is required</div>
      </div>

      <label class="label required" for="input-origin">Origin </label>
      <nb-icon icon="question-mark-circle" nbTooltip="Where the request originated from" nbTooltipStatus="primary"
        status="info"></nb-icon>
      <nb-select fullWidth placeholder="Select origin" formControlName="origin" id="input-origin">
        <nb-option [value]="origin" *ngFor="let origin of origins">{{origin}}</nb-option>
      </nb-select>
      <div *ngIf="submitted && form.origin.errors" class="invalid-feedback">
        <div *ngIf="form.origin.errors.required">Origin is required</div>
      </div>
      <br />

      <label class="label required" for="input-description">Description

      </label>
      <nb-icon icon="question-mark-circle" nbTooltip="Outline what needs to be delivered and provide some background"
        nbTooltipStatus="primary" status="info"></nb-icon>
      <textarea nbInput fullWidth type="text" formControlName="description" id="input-description"></textarea><br />
      <div *ngIf="submitted && form.description.errors" class="invalid-feedback">
        <div *ngIf="form.description.errors.required">Description is required</div>
      </div>
    </div>
  </div>
  <nb-tabset>

    <nb-tab tabTitle="Case Details" tabIcon="list">
      <div class="row">

        <div class="col">

          <label class="label required" for="input-schemes">Scheme
          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Scheme Departments" nbTooltipStatus="primary" status="info">
          </nb-icon>
          <nb-select fullWidth placeholder="Scheme Departments" formControlName="schemesDepartment"
            [disabled]="!(formData.schemesDepartment?.length === 0)" id="input-schemes">

            <nb-option [value]="scheme.name" *ngFor="let scheme of schemeList">{{scheme.name}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.schemesDepartment.errors" class="invalid-feedback">
            <div *ngIf="form.schemesDepartment.errors.required">Schemes department is required</div>
          </div>
          <br />

          <label class="label required" for="input-division">Divisions

          </label>
          <nb-icon icon="question-mark-circle"
            nbTooltip="From which department at the scheme did this request originate from" nbTooltipStatus="primary"
            status="info"></nb-icon>
          <nb-select fullWidth placeholder="Select Division" formControlName="division" id="input-division">
            <nb-option [value]="division.name" *ngFor="let division of divisions">{{division.name}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.division.errors" class="invalid-feedback">
            <div *ngIf="form.division.errors.required">Division is required</div>
          </div>
          <br />

          <label class="label required" for="input-priority">Priority

          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Assign priority level" nbTooltipStatus="primary"
            status="info"></nb-icon>
          <nb-select fullWidth placeholder="Select Priority" formControlName="priority" id="input-priority">
            <nb-option [value]="priority.value" *ngFor="let priority of priorities">{{priority.description}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.priority.errors" class="invalid-feedback">
            <div *ngIf="form.receiveprioritydFrom.errors.required">Priority is required</div>
          </div>
          <br />

          <label class="label required" for="input-fundAdministrator">Fund Administrator/Co-Ordinators

          </label>
          <nb-icon icon="question-mark-circle"
            nbTooltip="Find the person from the drop down who is supposed to action the request"
            nbTooltipStatus="primary" status="info"></nb-icon>

          <nb-select fullWidth placeholder="Fund Administrator" formControlName="fundAdministrator"
            id="input-fundAdministrator">
            <nb-option [value]="fundAdmin.email" (selectionChange)="selectedUser(fundAdmin, 'fundManager')"
              *ngFor="let fundAdmin of fundAdministratorList">{{fundAdmin.email}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.fundAdministrator.errors" class="invalid-feedback">
            <div *ngIf="form.fundAdministrator.errors.required">Fund Administrator is required</div>
          </div>
          <br />

          <label class="label required" for="input-manager">Fund Manager

          </label>
          <nb-icon icon="question-mark-circle"
            nbTooltip="Find the Head of Department responsible for the division in which the assigned person is reporting to"
            nbTooltipStatus="primary" status="info"></nb-icon>
          <br /><input fullWidth nbInput type="text" class="sb-text" readonly formControlName="fundManager"
            id="input-manager">
          <div *ngIf="submitted && form.fundManager.errors" class="invalid-feedback">
            <div *ngIf="form.fundManager.errors.required">Fund manager is required</div>
          </div>
          <br />

          <label class="label required" for="input-operation-user">Operation User

          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Find th Operations user" nbTooltipStatus="primary"
            status="info"></nb-icon>
          <nb-select fullWidth placeholder="Operation User" formControlName="operationsUser" id="input-operation-user">
            <nb-option [value]="ops.email" (selectionChange)="selectedUser(ops, 'operationsHod')"
              *ngFor="let ops of operationsList">{{ops.email}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.operationsUser.errors" class="invalid-feedback">
            <div *ngIf="form.operationsUser.errors.required">Operations user is required</div>
          </div>
          <!--            <input nbInput fullWidth type="text" formControlName="operationsUser" id="input-operation-user">-->
          <br />

          <label class="label required" for="input-operation-head">Head of Department

          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Find the Head of Department responsible for operations"
            nbTooltipStatus="primary" status="info"></nb-icon>
          <br /><input nbInput fullWidth readonly class="sb-text" type="text" formControlName="operationsHod"
            id="input-operation-head">
          <div *ngIf="submitted && form.receivedFrom.errors" class="invalid-feedback">
            <div *ngIf="form.receivedFrom.errors.required">Received from is required</div>
          </div>
          <br />
        </div>


        <div class="col">

          <label class="label required" for="input-operations-department">Operations Department

          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Operations Department" nbTooltipStatus="primary"
            status="info"></nb-icon>
          <nb-select fullWidth placeholder="Select Operations Department" formControlName="operationsDepartment"
            id="input-operations-department">
            <nb-option [value]="operationDept.name" *ngFor="let operationDept of operationDepartmentList">
              {{operationDept.name}}</nb-option>
          </nb-select>
          <div *ngIf="submitted && form.operationsDepartment.errors" class="invalid-feedback">
            <div *ngIf="form.operationsDepartment.errors.required">Operations department is required</div>
          </div>
          <br />

          <label class="label required" for="input-fundmanagement-department">Fund Management Team
          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Fund Management Team" nbTooltipStatus="primary" status="info">
          </nb-icon>
          <nb-select fullWidth placeholder="Select Fund Management Team" formControlName="fundManagementDepartment"
            id="input-fundmanagement-department">
            <nb-option [value]="fundDept.name" *ngFor="let fundDept of fundManagementDepartmentList">{{fundDept.name}}
            </nb-option>
          </nb-select>
          <div *ngIf="submitted && form.fundManagementDepartment.errors" class="invalid-feedback">
            <div *ngIf="form.fundManagementDepartment.errors.required">Fund management department is required</div>
          </div>
          <br />


          <div *ngIf="taskName === 'Manual Classification'">
            <label class="label" for="input-serviceProviderNetwork">Service Provider Network
            </label>
            <nb-icon icon="question-mark-circle" nbTooltip="Scheme" nbTooltipStatus="primary" status="info"></nb-icon>
            <nb-select fullWidth placeholder="Select Service Provider Network" formControlName="serviceProviderNetwork"
              id="input-serviceProviderNetwork" class="selectpicker" multiple>
              <nb-option [value]="serviceProviderNetwork.name"
                *ngFor="let serviceProviderNetwork of serviceProviderNetworks">{{serviceProviderNetwork.name}}
              </nb-option>
            </nb-select>
            <div *ngIf="submitted && form.serviceProviderNetwork.errors" class="invalid-feedback">
              <div *ngIf="form.serviceProviderNetwork.errors.required">Service provider network is required</div>
            </div>
            <br />
          </div>

          <label class="label" for="input-tags">Case Tag
          </label>
          <nb-icon icon="question-mark-circle" nbTooltip="Tag case, for later searching" nbTooltipStatus="primary"
            status="info"></nb-icon>
          <br />
          <input nbInput fullWidth class="sb-text" type="text" formControlName="tag" id="input-tags">
          <br />

          <div *ngIf="enableClassification">
            <label class="label" for="input-case-validity">Case Validity
            </label>
            <nb-icon icon="question-mark-circle" nbTooltip="Case validity" nbTooltipStatus="primary" status="info">
            </nb-icon>
            <nb-select fullWidth formControlName="caseValidity" id="input-case-validity">
              <nb-option [value]="result" *ngFor="let result of caseValidityList">{{result}}</nb-option>
            </nb-select>
          </div>


          <div *ngIf="enableTracking">
            <label class="label" for="input-close-or-reassign">Close or Reassign

            </label>
            <nb-icon icon="question-mark-circle" nbTooltip="Close or Reassign case" nbTooltipStatus="primary"
              status="info"></nb-icon>
            <nb-select fullWidth formControlName="closeCase" id="input-close-or-reassign">
              <nb-option [value]="result.value" *ngFor="let result of closeCaseList"
                (selectionChange)="selectedValue($event)">{{result.description}}</nb-option>
            </nb-select>
          </div>

          <div *ngIf="enableTracking && showClosureStatus">
            <label class="label" for="input-closure-status">Closure Reason
            </label>
            <nb-icon icon="question-mark-circle" nbTooltip="Close Reason" nbTooltipStatus="primary" status="info">
            </nb-icon>
            <nb-select fullWidth formControlName="closureStatus" id="input-closure-status">
              <nb-option [value]="result" *ngFor="let result of closureStatusList">{{result}}</nb-option>
            </nb-select>
          </div>

        </div>

      </div>
    </nb-tab>

    <nb-tab tabTitle="Case Dates" tabIcon="list">
      <div class="row">

        <div class="col">
          <br />
          <label class="label required" for="input-assignedDate">Created On
            <nb-icon icon="question-mark-circle" nbTooltip="To date you send the request to the assignee"
              nbTooltipStatus="primary" status="info"></nb-icon>
          </label>
          <input (dateTimeChange)="dateTime($event)" nbInput [owlDateTime]="assignedDate" formControlName="receivedDate"
            id="input-assignedDate" [owlDateTimeTrigger]="assignedDate" placeholder="Created On Date">
          <owl-date-time #assignedDate></owl-date-time>
          <div *ngIf="submitted && form.assignedDate.errors" class="invalid-feedback">
            <div *ngIf="form.assignedDate.errors.required">Assigned date is required</div>
          </div>
          <br />


          <label class="label required" for="input-receivedDate">Date Received
            <nb-icon icon="question-mark-circle" nbTooltip="Date the request was received from the Scheme"
              nbTooltipStatus="primary" status="info"></nb-icon>
          </label> <input (dateTimeChange)="dateTime($event)" nbInput [owlDateTime]="receivedDate"
            formControlName="receivedDate" id="input-receivedDate" [owlDateTimeTrigger]="receivedDate"
            placeholder="Date Received">
          <owl-date-time #receivedDate></owl-date-time>
          <div *ngIf="submitted && form.receivedDate.errors" class="invalid-feedback">
            <div *ngIf="form.receivedDate.errors.required">Received date is required</div>
          </div>
          <br />

          <label class="label" for="input-dueDate">Due Date
            <nb-icon icon="question-mark-circle" nbTooltip="To track when the request is due for delivery"
              nbTooltipStatus="primary" status="info"></nb-icon>
          </label>
          <input (dateTimeChange)="dateTime($event)" nbInput [owlDateTime]="dt1" formControlName="dueDate"
            [owlDateTimeTrigger]="dt1" id=input-dueDate placeholder="Due Date">
          <owl-date-time #dt1></owl-date-time>
          <br />

          <label class="label" for="input-receiptAcknowledgementDate">Acknowledged On Date
            <nb-icon icon="question-mark-circle" nbTooltip="To track when we acknowledged request"
              nbTooltipStatus="primary" status="info"></nb-icon>
          </label>
          <input (dateTimeChange)="dateTime($event)" nbInput [owlDateTime]="receiptAcknowledgementDate"
            formControlName="receiptAcknowledgementDate" [owlDateTimeTrigger]="receiptAcknowledgementDate"
            id="input-receiptAcknowledgementDate" placeholder="Acknowledged Date">
          <owl-date-time #receiptAcknowledgementDate></owl-date-time>

          <br />


          <label class="label" for="input-submissionDate">Completed Date
            <nb-icon icon="question-mark-circle"
              nbTooltip="Select the date in which the enquiry was completed and send to the requestor"
              nbTooltipStatus="primary" status="info"></nb-icon>
          </label>
          <!--            <input nbInput formControlName="submissionDate" id="input-submissionDate"-->
          <!--                            [nbDatepicker]="submissionDate">-->
          <!--            <nb-datepicker #submissionDate ></nb-datepicker>-->

          <input (dateTimeChange)="dateTime($event)" nbInput [owlDateTime]="submissionDate"
            formControlName="receiptAcknowledgementDate" [owlDateTimeTrigger]="submissionDate" id="input-submissionDate"
            placeholder="Completed Date">
          <owl-date-time #submissionDate></owl-date-time>



          <br />

          <!--        <label class="label" for="input-tags">Case Tag-->
          <!--          <nb-icon icon="question-mark-circle"-->
          <!--                   nbTooltip="Tag case, for later searching"-->
          <!--                   nbTooltipStatus="primary" status="info"></nb-icon>-->
          <!--        </label><input nbInput fullWidth type="text" formControlName="tag" id="input-tags">-->
          <!--        <br/>-->

          <!--        <div *ngIf="enableClassification">-->
          <!--        <label class="label" for="input-case-validity">Case Validity-->
          <!--          <nb-icon icon="question-mark-circle" nbTooltip="Case validity"-->
          <!--                   nbTooltipStatus="primary" status="info"></nb-icon>-->
          <!--        </label>-->
          <!--        <nb-select formControlName="caseValidity"-->
          <!--                   id="input-case-validity">-->
          <!--          <nb-option [value]="result" *ngFor="let result of caseValidityList">{{result}}</nb-option>-->
          <!--        </nb-select>-->
          <!--        </div>-->


          <!--        <div *ngIf="enableTracking">-->
          <!--          <label class="label" for="input-close-or-reassign">Close or Reassign-->
          <!--            <nb-icon icon="question-mark-circle" nbTooltip="Close or Reassign case"-->
          <!--                   nbTooltipStatus="primary" status="info"></nb-icon>-->
          <!--          </label>-->
          <!--          <nb-select formControlName="closeCase"-->
          <!--                   id="input-close-or-reassign">-->
          <!--            <nb-option-->
          <!--              [value]="result.value" *ngFor="let result of closeCaseList"-->
          <!--              (selectionChange)="selectedValue($event)">{{result.description}}</nb-option>-->
          <!--          </nb-select>-->
          <!--        </div>-->

          <!--        <div *ngIf="enableTracking && showClosureStatus">-->
          <!--        <label class="label" for="input-closure-status">Closure Reason-->
          <!--          <nb-icon icon="question-mark-circle" nbTooltip="Close Reason"-->
          <!--                   nbTooltipStatus="primary" status="info"></nb-icon>-->
          <!--        </label>-->
          <!--        <nb-select formControlName="closureStatus"-->
          <!--                   id="input-closure-status">-->
          <!--          <nb-option [value]="result" *ngFor="let result of closureStatusList">{{result}}</nb-option>-->
          <!--        </nb-select>-->
          <!--      </div>-->


        </div>
      </div>
    </nb-tab>

  </nb-tabset>

  <div class="row">
    <div class="col">
      <button [disabled]="!taskCompleted" nbButton type="submit" color="blue" (click)="formSubmit(caseForm)">Submit
      </button>
      &nbsp;&nbsp;
      <button nbButton type="button" color="blue" (click)="saveCaseData(caseForm)">Save</button>
    </div>
  </div>

  <!-- <button nbButton type="submit"  size="default" color="primary" [disabled]="!caseForm.valid" >Submit</button> -->
</form>